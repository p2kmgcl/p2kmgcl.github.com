<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	<link href="http://fonts.googleapis.com/css?family=Josefin+Sans:100" rel="stylesheet"/>
	<style>body {
  font-family: 'Josefin Sans';
  font-size: 180px;
  font-weight: 600;
}
#remainingCurrent {
  display: table-cell;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  color: white;
  text-align: center;
  vertical-align: middle;
  line-height: 100%;
  transition: background-color ease 1.5s;
}
#remainingCurrent.heating {
  background-color: #00B4FF;
}
#remainingCurrent.intense {
  background-color: #FF4B4B;
}
#remainingCurrent.relaxed {
  background-color: #59A80F;
}
#remainingCurrent > time {
  position: absolute;
  top: 40%;
  left: 0;
  width: 100%;
  height: 0;
}
#remainingCurrent > time > span {
  display: inline-block;
  width: 1.4em;
}
@media (max-width: 1000px) {
  body {
    font-size: 125px;
  }
}
@media (max-width: 600px) {
  body {
    font-size: 100px;
  }
}
@media (max-width: 400px) {
  body {
    font-size: 70px;
  }
}

	</style>
</head>
<body>
	<div id="remainingCurrent" class="heating"></div>
	<div id="remainingTotal" class="total"></div>
	<script>
	(function() {
	  var $current, $total, MINUTE, SECOND, countDown, difference, exerciseLoop, hasRelax, heating, options, periodDuration, remaining, totalDuration;

	  heating = 10;

	  periodDuration = 5;

	  totalDuration = 30;

	  options = window.location.hash.substr(1, window.location.hash.length - 1).split('|');
	  console.log(options);

	  if (options.length === 3) {
	    heating = parseFloat(options[0]);
	    periodDuration = parseFloat(options[1]);
	    totalDuration = parseFloat(options[2]);
	  }

	  console.log(heating);
	  console.log(periodDuration);
	  console.log(totalDuration);

	  SECOND = 1000;

	  MINUTE = 60000;

	  $current = document.getElementById('remainingCurrent');

	  $total = document.getElementById('remainingTotal');

	  difference = function(time1, time2) {
	    var diff, minutes, seconds;
	    diff = time2 - time1;
	    minutes = 0;
	    seconds = 0;
	    while (diff - MINUTE > 0) {
	      minutes++;
	      diff -= MINUTE;
	    }
	    while (diff - SECOND > 0) {
	      seconds++;
	      diff -= SECOND;
	    }
	    if (minutes < 10) {
	      minutes = '0' + minutes;
	    }
	    if (seconds < 10) {
	      seconds = '0' + seconds;
	    }
	    return "<span>" + minutes + "</span>:<span>" + seconds + "</span>";
	  };

	  countDown = function(time, className, callback) {
	    var counter, end;
	    if (className == null) {
	      className = '';
	    }
	    if (callback == null) {
	      callback = (function() {});
	    }
	    $current.className = className;
	    end = ((new Date()).getTime()) + (time * MINUTE);
	    counter = function() {
	      var now;
	      now = (new Date()).getTime();
	      if (now >= end) {
	        return callback();
	      } else {
	        $current.innerHTML = "<time>" + (difference(now, end)) + "</time>";
	        return setTimeout(counter, 100);
	      }
	    };
	    return counter();
	  };

	  remaining = totalDuration - heating;

	  hasRelax = true;

	  exerciseLoop = function() {
	    if (remaining > 0) {
	      if (hasRelax) {
	        hasRelax = false;
	        remaining -= periodDuration;
	        return countDown(periodDuration, 'intense', exerciseLoop);
	      } else {
	        hasRelax = true;
	        remaining -= periodDuration / 2;
	        return countDown(periodDuration / 2, 'relaxed', exerciseLoop);
	      }
	    }
	  };

	  countDown(heating, 'heating', function() {
	    return exerciseLoop();
	  });

	}).call(this);
</script>
</body>
</html>
